---
title: Make
mathjax: true
layout: default
toc: true
---



# Make



* make with no arguments executes the first rule in the file. 
* special constants 
  * CFLAGS is the list of flags to pass to the compilation command.


```
# This is called a rule
target … : prerequisites …
        recipe
        …
        …
```

A target is usually the name of a file that is generated by a program

A prerequisite is a file that is used as input to create the target. A target often depends on several files.

A recipe is an action that make carries out. A recipe may have more than one command, either on the same line or each on its own line. 



Automatic Variables
* they only have values within the recipe. 
	* Don't use in target list
	* Don't use in prerequisite list
* $@ - file name of the target being generated
* $% - target member name when the target is an archive member.
* $< - name of the first prerequisite
* $? - names of all the prerequisites that are newer than the target, with spaces between them
* $^ - names of all the prerequisites (no repeat)
* $+ - names of all the prerequisites (repeat allowed)
* $| - names of all the order-only prerequisites
* $* - stem with which an implicit rule matches


Normally make prints each line of the recipe before it is executed.
When a line starts with ‘@’, the echoing of that line is suppressed. The ‘@’ is discarded before the line is passed to the shell. 

When make is given the flag ‘-n’ it only echoes most recipes, without executing them.



# Variables

recursively expanded variable (=)
any functions
Simply expanded variables are defined by lines using (:=)
scanned once and for all
It does not contain any references to other variables; it contains their values as of the time this variable was defined. 

conditional variable assignment (?=)
only has an effect if the variable is not yet defined


# Functions

* $(subst from,to,text)
* $(strip string) -  Removes leading and trailing whitespace from string and replaces each internal sequence of one or more whitespace characters with a single space
* $(findstring find,in)
* $(word n,text) - Returns the nth word of text (start from 1)
* $(words text) - Returns the number of words in text

```makefile

CC=gcc
CFLAGS=-I.
DEPS = hellomake.h

%.o: %.c $(DEPS)
	$(CC) -c -o $@ $< $(CFLAGS)

hellomake: hellomake.o hellofunc.o 
	$(CC) -o hellomake hellomake.o hellofunc.o 

```



$@ says to put the output of the compilation in the file named on the left side of the :, the $< is the first item in the dependencies list, and the CFLAGS macro is defined as above.





 ```makefile
# ________________________________________________________________________________
# DEVELOPMNET
# ________________________________________________________________________________
APP_DIR = ./src



default: src/main/mainApp.go
	go run src/main/mainApp.go

test:
	go test ./src/... -v

# ________________________________________________________________________________
# PRODUCTION
# ________________________________________________________________________________


# ________________________________________________________________________________
# INFO
# ________________________________________________________________________________
.PHONY: info

info:
	@go version

 ```


https://www.gnu.org/software/make/manual/html_node/index.html#SEC_Contents

References
https://www.cs.colby.edu/maxwell/courses/tutorials/maketutor/




https://stackoverflow.com/questions/19475037/function-and-difference-between-and-in-makefile/19476225